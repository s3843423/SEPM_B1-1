<!DOCTYPE html>
<html lang="en">

<head>

    <script>

        function processFile() {
            var fileSize = 0;
            var noOfRows = 0;
            var lines;
            //get file
            var theFile = document.getElementById("myFile");


            //regex for csv and xlsx files
            var regex = new RegExp("(.*?)\.(csv)$");
            var regex2 = new RegExp("(.*?)\.(xlsx)$")
            //check if file is CSV or XLSX
            if (regex.test(theFile.value.toLowerCase()) || regex2.test(theFile.value.toLowerCase())) {
                //check if browser support FileReader
                if (typeof (FileReader) != "undefined") {
                    //get table element
                    var table = document.getElementById("myTable");
                    var headerLine = "";
                    //create html5 file reader object
                    var myReader = new FileReader();
                    // call filereader. onload function
                    myReader.onload = function (e) {
                        var content = myReader.result;
                        //split csv file using "\n" for new line ( each row)
                        lines = content.split("\r");
                        //records size cannot be more than 422 
                        console.log("line count :" + lines.length);
                        if (lines.length <= 422) {
                            //loop all rows
                            for (var count = 0; count < lines.length; count++) {

                                var rowContent = lines[count].split(/,(?=(?:(?:[^'"]*(?:'|")){2})*[^'"]*$)/);
                                if (count == 0) {

                                    //check data on each cell of the headers to check whether the column name matches exactly with the expected column name 
                                    if (rowContent[0] != 'ID' || rowContent[1] != 'Start time' || rowContent[2] != 'Completion time' || rowContent[3] != 'Email' || rowContent[4] != 'Name' || rowContent[5] != 'Your name  (FirstName LastName)' || rowContent[6] != 'Your student ID' ||
                                        rowContent[7] != 'Your workshop class' || rowContent[8] != '"If you prefer to be in a team with particular students, list their student IDs separated by commas (max. 6 student IDs):"' || rowContent[9] != 'What project option do you prefer?' ||
                                        rowContent[10] != 'What technologies/languages would you prefer to use in project?' ||
                                        rowContent[11] != 'Timezone in which the team should preferably work' || rowContent[12] != 'Preferred week days for team work?' || rowContent[13] != 'Preferred day/nightÂ times for team-work') {

                                        alert("Header names do not exactly match hence the file cannot be used for team generation, please upload a new file with proper headers");

                                    }
                                    else {
                                        alert(" File uploaded successfully in the correct format ");
                                    }
                                }



                            }
                        }
                        else {
                            alert("record size can be maximum 422");
                        }
                    }
                    //call file reader onload

                    myReader.readAsText(theFile.files[0]);
                    //   console.log(lines.length);
                }
                else {
                    alert("This browser does not support HTML5.");
                }

            }
            else {
                alert("Please upload a valid CSV file.");
            }
            return false;
        }

    </script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Creation Tool</title>

    <!-- <link rel="stylesheet" href="styles/index.css" /> -->

    <!-- Bootstrap CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Add jQuery and Bootstrap JS necessary CDNs -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="wrapper">
        <!-- HEADER -->
        <div class=" p-5 bg-warning">
            <!-- Heading -->
            <div id="heading" class="tool_header display-1 text-center">
                <h1>TEAM CREATION TOOL</h1>
            </div>
        </div>

        <div class="display-4 text-center">


            <input type="file" accept=".csv,.xlsx" id="myFile">
            <br><br>
            <form action=" ">
                <label for="min">Minimum value: </label>
                <select name="min" id="min">
                    <option value="default_min">5</option>
                </select>
                <label for="max">Maximum value: </label>
                <select name="max" id="max">
                    <option value="default_max">7</option>
                </select>

                <br><br>

            </form>

            <button onclick='processFile()'>Submit</button>



        </div>

        <!-- <div class="footer p-4 bg-warning">
            <p></p>
        </div> -->
    </div>

</body>

</html>